<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <title>Przypadek.pl — Asystent przypadków klinicznych</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
    /* ===== Dark (charcoal/grey) theme with green accents ===== */
    :root{
      color-scheme: dark;

      /* szaro-grafitowa paleta (bez granatów) */
      --bg: #0f1012;         /* tło główne */
      --surface: #151617;    /* header / pasek */
      --surface-2: #1a1b1d;  /* karty */
      --text: #eceff1;       /* tekst bazowy */
      --muted: #a6abb0;      /* tekst drugorzędny */
      --border: #26292b;     /* obramowania */

      /* zielone akcenty */
      --green-300:#86efac;
      --green-400:#59d98a;
      --green-500:#2ec66d;
      --green-600:#1eaa59;
      --green-700:#16894a;

      --ring: 0 0 0 3px rgba(46,198,109,.25);
      --radius-xl: 18px;
      --radius-lg: 14px;

      font-family: "Inter", system-ui, -apple-system, "Segoe UI", sans-serif;
    }

    *{ box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0; padding: 0;
      background:
        radial-gradient(900px 600px at 15% -10%, rgba(255,255,255,.05), transparent 60%),
        radial-gradient(700px 500px at 110% -20%, rgba(255,255,255,.03), transparent 70%),
        var(--bg);
      color: var(--text);
    }

    header {
      padding: 32px 20px 24px;
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)) , var(--surface);
      border-bottom: 1px solid var(--border);
      position: sticky; top: 0; z-index: 10;
      backdrop-filter: saturate(130%) blur(6px);
    }

    .wrapper { max-width: 1040px; margin: 0 auto; padding: 0 20px 48px; }

    nav {
      display: flex; justify-content: flex-end; gap: 12px; margin-bottom: 36px; align-items: center;
    }
    nav a {
      padding: 10px 18px; border-radius: 999px;
      border: 1px solid rgba(46,198,109,.35);
      background: transparent; color: var(--green-400);
      text-decoration: none; font-weight: 600;
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
    }
    nav a.primary {
      background: linear-gradient(180deg, var(--green-600), var(--green-700));
      border-color: var(--green-700); color: white;
      box-shadow: 0 14px 30px -18px rgba(46,198,109,.5);
    }
    nav a:hover { transform: translateY(-1px); background: rgba(46,198,109,.08); }
    nav a.primary:hover { background: linear-gradient(180deg, var(--green-500), var(--green-700)); }
    nav a:focus-visible { outline: none; box-shadow: var(--ring); }

    h1 { margin: 0 0 12px; font-size: 44px; letter-spacing: -0.5px; color: #f4f6f8; }
    p.lead { margin: 0; max-width: 680px; font-size: 18px; color: var(--muted); line-height: 1.65; }

    /* karty / siatka (widok niezalogowany) */
    .grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 20px; margin: 48px 0 32px;
    }
    .card {
      background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)) , var(--surface-2);
      border-radius: var(--radius-xl);
      padding: 24px;
      border: 1px solid var(--border);
      box-shadow: 0 18px 50px -35px rgba(0,0,0,.8);
    }
    .card h2 { margin-top: 0; font-size: 20px; color: #f7fafc; }

    ul.features { list-style: none; padding: 0; margin: 0; display: grid; gap: 12px; }
    ul.features li { display: flex; gap: 12px; align-items: flex-start; }
    ul.features li span.icon {
      display: inline-flex; width: 28px; height: 28px; border-radius: 8px;
      background: rgba(46,198,109,.15); color: var(--green-400);
      align-items: center; justify-content: center; font-size: 16px; flex: none;
      border: 1px solid rgba(46,198,109,.3);
    }

    .cta { margin-top: 12px; display: inline-flex; gap: 12px; flex-wrap: wrap; }
    .cta a {
      padding: 12px 20px; border-radius: 12px; text-decoration: none; font-weight: 600;
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
      border: 1px solid rgba(46,198,109,.35);
      color: var(--green-300);
      background: rgba(46,198,109,.06);
    }
    .cta a.primary {
      background: linear-gradient(180deg, var(--green-600), var(--green-700));
      color: white; border-color: var(--green-700);
      box-shadow: 0 14px 30px -18px rgba(46,198,109,.5);
    }
    .cta a.secondary:hover { background: rgba(46,198,109,.1); }
    .cta a:hover { transform: translateY(-1px); }

    /* układ po zalogowaniu */
    .layout { display: grid; grid-template-columns: 1.2fr .8fr; gap: 20px; align-items: start; margin: 48px 0 32px; }
    .cases { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 8px; }
    .case {
      border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 16px;
      background: #141516;
      display: flex; flex-direction: column; gap: 8px;
    }
    .case h3 { margin: 0; font-size: 17px; color: #f0f3f6; }
    .case p { margin: 0; color: var(--muted); font-size: 14px; }

    .actions { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
    .btn {
      border-radius: 10px; padding: 9px 14px; text-decoration: none; font-weight: 600; line-height: 1;
      border: 1px solid rgba(46,198,109,.35); color: var(--green-300);
      background: rgba(46,198,109,.06);
      transition: transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease;
    }
    .btn:hover { background: rgba(46,198,109,.1); transform: translateY(-1px); }
    .btn.primary { background: linear-gradient(180deg, var(--green-600), var(--green-700)); border-color: var(--green-700); color: white; }
    .btn.primary:hover { background: linear-gradient(180deg, var(--green-500), var(--green-700)); }

    .panel-empty {
      border: 2px dashed rgba(255,255,255,.12);
      border-radius: var(--radius-xl);
      padding: 24px;
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));
      color: var(--muted);
      text-align: center; min-height: 260px;
      display: flex; align-items: center; justify-content: center;
    }
    .panel-empty strong { color: #f0fff4; }

    footer {
      padding: 28px 20px; text-align: center; color: #9aa0a6; font-size: 14px;
      border-top: 1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,.02));
    }

    @media (prefers-reduced-motion: reduce){ *{ transition: none !important; } }
    @media (max-width: 860px){ .layout { grid-template-columns: 1fr; } }
  </style>

</head>
<body>
  <header>
    <div class="wrapper">
      <nav>
        {% if request.user.is_authenticated %}
          <span style="align-self:center; color:var(--muted);">Witaj, {{ request.user.username }}!</span>
          <a class="primary" href="{% url 'logout' %}">Wyloguj się</a>
        {% else %}
          <a class="ghost" href="{% url 'login' %}">Zaloguj się</a>
          <a class="primary" href="{% url 'register' %}">Zarejestruj się</a>
        {% endif %}
      </nav>
      <h1>Przypadek.pl</h1>
      <p class="lead">Platforma treningowa dla zespołów medycznych. Prowadzimy Cię przez kluczowe etapy decyzji klinicznych i pomagamy przećwiczyć trudne scenariusze zanim spotkasz je w realnej praktyce.</p>
    </div>
  </header>

  <main class="wrapper">
    {% if request.user.is_authenticated %}
      <!-- Widok po zalogowaniu: lista przypadków + placeholder -->
      <div class="layout">
        <section class="card" id="twoje-przypadki">
          <h2>Twoje przypadki</h2>
          <div class="cases">
            {% for c in cases %}
              <article class="case">
                <h3>{{ c.name }}</h3>
                <p>{{ c.short_description|default:"Bez opisu" }}</p>
                <div class="actions">
                  <a class="btn primary" href="{% url 'chat-stage' c.slug sample_stage|default:'diagnostics' %}">Start</a>
                  {# Jeśli masz widok detalu: <a class="btn" href="{% url 'case-detail' c.slug %}">Szczegóły</a> #}
                </div>
              </article>
            {% empty %}
              <p>Brak dostępnych przypadków.</p>
            {% endfor %}
          </div>
        </section>

        <aside class="card">
          <div class="panel-empty">
            <div>
               {% if request.user.is_authenticated %}
                <a class="btn primary" href="{% url 'completed-grouped' %}">Ukończone przypadki</a>
               {% endif %}
            </div>
          </div>
        </aside>
      </div>
    {% else %}
      <!-- Widok dla niezalogowanych: trzy karty -->
      <div class="grid">
        <section class="card">
          <h2>Co zyskujesz?</h2>
          <ul class="features">
            {% for item in features %}
              <li>
                <span class="icon">✓</span>
                <span>{{ item }}</span>
              </li>
            {% endfor %}
          </ul>
        </section>

        <section class="card">
          <h2>Nowy w Przypadek.pl?</h2>
          <p style="color:var(--muted)">Zarejestruj konto, aby zapisywać postępy, budować własne scenariusze i współdzielić je z zespołem.</p>
          <div class="cta">
            <a class="primary" href="{% url 'register' %}">Utwórz konto</a>
            <a class="secondary" href="{% url 'login' %}">Mam już konto</a>
          </div>
        </section>

        <section class="card">
          <h2>Przetestuj darmowy przypadek</h2>
          {% if sample_case and sample_stage %}
            <p style="color:var(--muted)">Przejdź przez pierwszy etap przypadku <strong style="color:#e6ffe6">{{ sample_case.name }}</strong> i sprawdź jak działa nasz wirtualny asystent.</p>
            <div class="cta">
              <a class="primary" href="{% url 'chat-stage' sample_case.slug sample_stage %}">Rozpocznij trening</a>
            </div>
          {% else %}
            <p style="color:var(--muted)">Wkrótce udostępnimy pierwszy darmowy scenariusz.</p>
          {% endif %}
        </section>
      </div>
    {% endif %}
  </main>

  <footer>
    © {% now "Y" %} Przypadek.pl. Wszystkie prawa zastrzeżone.
  </footer>
</body>
</html>
