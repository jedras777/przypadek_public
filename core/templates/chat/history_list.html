<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8">
  <title>Moje zapisy — Przypadek.pl</title>
  <style>
    :root{
      color-scheme: dark;
      --bg:#0f1012; --surface:#151617; --surface-2:#1a1b1d;
      --text:#eceff1; --muted:#a6abb0; --border:#26292b;
      --green-500:#2ec66d; --radius-xl:18px;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    }
    body{
      margin:0; padding:32px 20px;
      background:
        radial-gradient(900px 600px at 15% -10%, rgba(255,255,255,.05), transparent 60%),
        radial-gradient(700px 500px at 110% -20%, rgba(255,255,255,.03), transparent 70%),
        var(--bg);
      color:var(--text);
    }
    .wrapper{ max-width: 1100px; margin: 0 auto; }
    .topbar{ display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:20px }
    .back{ text-decoration:none; padding:8px 12px; border-radius:10px; border:1px solid var(--border); background:#1a1b1d; color:var(--text) }
    h1{ margin:0; font-size:26px; }
    .list{ display:grid; gap:12px; }
    .card{ background:#1a1b1d; border:1px solid var(--border); border-radius:var(--radius-xl); padding:14px; display:flex; justify-content:space-between; align-items:center; }
    .meta{ display:flex; flex-direction:column; gap:6px; }
    .name{ font-weight:700; }
    .muted{ color:var(--muted); font-size:14px; }
    .tags{ display:flex; gap:8px; flex-wrap:wrap; }
    .tag{ padding:4px 8px; border-radius:999px; border:1px solid var(--border); background:#141516; font-size:12px; }
    .actions{ display:flex; gap:8px; }
    .btn{ padding:10px 14px; border-radius:10px; border:1px solid var(--border); background:#141516; color:var(--text); text-decoration:none; font-weight:600 }
    .btn.primary{ border-color:#167f48; background:linear-gradient(180deg,#1eaa59,#16894a); color:#fff }
    .empty{ text-align:center; color:var(--muted); padding:24px; border:1px dashed var(--border); border-radius:12px; background:#141516; }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="topbar">
      <a class="back" href="{% url 'home' %}">← Wróć</a>
      <h1>Moje zapisy</h1>
      <div></div>
    </div>

    {% if items %}
      <div class="list">
        {% for h in items %}
          <div class="card">
            <div class="meta">
              <div class="name">{{ h.case.name }}</div>
              <div class="muted">{{ h.created_at|date:"Y-m-d H:i" }}</div>
              <div class="tags">
                <span class="tag">Zaliczone: {{ h.completed_stages|length }}</span>
                {% if h.is_completed %}<span class="tag">✔ zakończony</span>{% endif %}
              </div>
            </div>
            <div class="actions">

              <form method="post" action="{% url 'case-reset' h.case.slug %}">
                {% csrf_token %}
                <button class="btn primary" type="submit">Uruchom ponownie</button>
              </form>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="empty">Nie masz jeszcze zapisanych historii. Ukończ przypadek, aby zapisać go na koncie.</div>
    {% endif %}
  </div>
</body>
</html>
